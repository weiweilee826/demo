"use strict";(self["webpackChunkoats2022"]=self["webpackChunkoats2022"]||[]).push([[1],{7546:function(t,e,n){n.d(e,{Xq:function(){return a},al:function(){return c},dv:function(){return s},wv:function(){return l}});var o=n(4311);async function l(t){let e;const n=`https://vue-course-api.hexschool.io/api/weiwei2022/product/${t}`;return await o.Z.get(n).then((t=>{t.data.success&&(e=t.data.product)})),e}async function a(t,e){let n;const l={product_id:t,qty:e},a="https://vue-course-api.hexschool.io/api/weiwei2022/cart";return await o.Z.post(a,{data:l}).then((t=>{n=t.data.success})),n}async function s(){let t;const e="https://vue-course-api.hexschool.io/api/weiwei2022/cart";return await o.Z.get(e).then((e=>{t=e.data.data.carts})),t}function c(t){let e;const n=`https://vue-course-api.hexschool.io/api/weiwei2022/cart/${t}`;return o.Z["delete"](n).then((t=>{e=t})),e}},7001:function(t,e,n){n.r(e),n.d(e,{default:function(){return X}});var o=n(3396),l=n(7139),a=n(9242);const s={class:"container content"},c=(0,o._)("h1",{class:"title fw-bold"},"CART",-1),i={key:0,class:"text-center"},u=(0,o._)("p",{class:"fw-bold text-white"},"您的購物車是空的",-1),r=(0,o._)("button",{type:"button",class:"btn btn-outline-light checkout rounded-pill mt-5 fw-bold",style:{width:"220px"}}," 繼續購物 ",-1),d={key:1},p={class:"table mt-4"},h=(0,o._)("thead",{class:"text-white"},[(0,o._)("tr",null,[(0,o._)("th",{width:"80px"}),(0,o._)("th",null,"商品"),(0,o._)("th",{width:"10%"},"單價"),(0,o._)("th",{width:"10%"},"數量"),(0,o._)("th",{width:"10%"},"小計")])],-1),_={class:"text-white"},w=["src"],f={class:"align-middle"},y=(0,o._)("br",null,null,-1),b=["onClick"],g={class:"text-end pl-1 align-middle"},m={class:"align-middle"},x=["onUpdate:modelValue","onChange"],v=["value"],k={class:"align-middle text-end"},C=(0,o._)("td",{colspan:"2"},null,-1),U={colspan:"3",class:"py-3"},D={class:"input-group"},q={class:"border_x"},$={colspan:"5",class:"text-end py-3"},z={class:"fw-bold"},S=(0,o._)("br",null,null,-1),Z=(0,o._)("br",null,null,-1),W={class:"text-end mt-3"},T=(0,o._)("button",{type:"button",class:"btn btn-outline-light text-center checkout"}," 前往結帳 ",-1);function V(t,e,n,V,H,K){const N=(0,o.up)("router-link"),Q=(0,o.up)("font-awesome-icon");return(0,o.wg)(),(0,o.iD)("div",s,[c,0==H.carts.length?((0,o.wg)(),(0,o.iD)("div",i,[u,(0,o.Wm)(N,{to:"/products"},{default:(0,o.w5)((()=>[r])),_:1})])):((0,o.wg)(),(0,o.iD)("div",d,[(0,o._)("table",p,[h,(0,o._)("tbody",_,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(H.carts,(e=>((0,o.wg)(),(0,o.iD)("tr",{key:e.id},[(0,o._)("td",null,[(0,o._)("img",{class:"img-fluid",src:e.product.imageUrl,style:{margin:"10px 0"},alt:""},null,8,w)]),(0,o._)("td",f,[(0,o.Wm)(N,{to:"/product/"+e.product_id},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(e.product.title),1)])),_:2},1032,["to"]),y,(0,o._)("button",{type:"button",class:"btn btn-outline-light btn-sm rounded-pill",style:{"margin-top":"10px"},onClick:t=>K.deleteCart(e.id)},[(0,o.Wm)(Q,{icon:"fa-solid fa-trash"}),(0,o.Uk)(" 刪除 ")],8,b)]),(0,o._)("td",g,(0,l.zw)(t.$filters.currencyUSD(e.product.price)),1),(0,o._)("td",m,[(0,o.wy)((0,o._)("select",{class:"form-select","aria-label":"Default select example","onUpdate:modelValue":t=>e.qty=t,onChange:t=>K.updatedQty(e)},[((0,o.wg)(),(0,o.iD)(o.HY,null,(0,o.Ko)(10,(t=>(0,o._)("option",{key:t,value:t},(0,l.zw)(t),9,v))),64))],40,x),[[a.bM,e.qty]])]),(0,o._)("td",k,(0,l.zw)(t.$filters.currencyUSD(e.product.price*e.qty)),1)])))),128)),(0,o._)("tr",null,[C,(0,o._)("td",U,[(0,o._)("div",D,[(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",placeholder:"折扣輸入【ten%off】","onUpdate:modelValue":e[0]||(e[0]=t=>H.coupon=t)},null,512),[[a.nr,H.coupon]]),(0,o._)("button",{class:"btn btn-outline-light",type:"button",id:"button-addon2",onClick:e[1]||(e[1]=t=>K.useCoupon())}," 套用優惠券 ")])])]),(0,o._)("tr",q,[(0,o._)("td",$,[(0,o._)("p",z,[(0,o.Uk)(" 總計 "+(0,l.zw)(t.$filters.currencyUSD(K.countTotal)),1),S,Z,(0,o.Uk)(" 折扣價 "+(0,l.zw)(t.$filters.currencyUSD(H.discount_total)),1)])])])])]),(0,o._)("div",W,[(0,o.Wm)(N,{to:"/cart_info"},{default:(0,o.w5)((()=>[T])),_:1})])]))])}var H=n(7546),K={data(){return{carts:[],products_qty:{},coupon:"",discount_total:0}},methods:{async getCart(){this.carts=await(0,H.dv)(),this.$store.state.cartNum=this.carts.length,this.$store.state.carts=this.carts,localStorage.setItem("carts",JSON.stringify(this.carts))},deleteCart(t){(0,H.al)(t),this.getCart()},updatedQty(t){this.deleteCart(t.id),(0,H.Xq)(t.product_id,t.qty)},useCoupon(){const t="https://vue-course-api.hexschool.io/api/weiwei2022/coupon";let e={data:{code:this.coupon}};this.$http.post(t,e).then((t=>{console.log("套用優惠券",t),this.discount_total=t.data.data.final_total}))}},computed:{countTotal(){return this.carts.reduce((function(t,e){return t+e.qty*e.product.price}),0)}},created(){this.getCart()}},N=n(89);const Q=(0,N.Z)(K,[["render",V]]);var X=Q}}]);
//# sourceMappingURL=1.733b5b7c.js.map
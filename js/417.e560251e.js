"use strict";(self["webpackChunkoats2022"]=self["webpackChunkoats2022"]||[]).push([[417],{5144:function(t,e,a){a.r(e),a.d(e,{default:function(){return G}});var l=a(3396),o=a(7139),r=a(9242);const d={class:"container-fluid"},i={class:"container"},n={class:"table mt-4"},s=(0,l._)("thead",null,[(0,l._)("tr",{class:"text-center"},[(0,l._)("th",null,"購買時間"),(0,l._)("th",null,"Email"),(0,l._)("th",null,"購買款項"),(0,l._)("th",null,"購買金額"),(0,l._)("th",null,"是否付款"),(0,l._)("th",null,"編輯")])],-1),c=["innerHTML"],u={class:"text-end"},p={key:0},m={key:1},_={class:"text-center"},h=["onClick"],f={class:"modal fade",id:"orderModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},g={class:"modal-dialog modal-lg",role:"document"},b={class:"modal-content border-0"},w=(0,l._)("div",{class:"modal-header"},[(0,l._)("h5",{class:"modal-title",id:"exampleModalLabel"},[(0,l._)("span",null,"編輯訂單")])],-1),y={class:"modal-body row"},O={class:"col-8"},v={class:"form-floating mb-3"},k=(0,l._)("label",{for:"floatingInput"},"購買時間",-1),x={class:"col-6"},M={class:"form-floating mb-3"},$=(0,l._)("label",{for:"floatingInput"},"Email",-1),D={class:"form-floating mb-3"},L=(0,l._)("label",{for:"floatingInput"},"購買款項",-1),C={class:"form-floating mb-3"},I=(0,l._)("label",{for:"floatingInput"},"購買金額",-1),U={class:"form-check form-switch text-start"},P=(0,l._)("label",{class:"form-check-label",for:"flexSwitchCheckDefault"},"是否付款",-1),V={class:"modal-footer"};function z(t,e,a,z,S,H){const T=(0,l.up)("PagiNation");return(0,l.wg)(),(0,l.iD)("div",d,[(0,l._)("div",i,[(0,l._)("table",n,[s,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(S.orders,(e=>((0,l.wg)(),(0,l.iD)("tr",{key:e.id,class:"text-center"},[(0,l._)("td",null,(0,o.zw)(e.create_at),1),(0,l._)("td",null,(0,o.zw)(e.email),1),(0,l._)("td",{class:"text-start",innerHTML:e.product},null,8,c),(0,l._)("td",u,(0,o.zw)(t.$filters.currencyUSD(e.total)),1),e.is_paid?((0,l.wg)(),(0,l.iD)("td",p,"已付款")):((0,l.wg)(),(0,l.iD)("td",m,"未付款")),(0,l._)("td",_,[(0,l._)("button",{class:"btn btn-outline-dark",onClick:t=>H.openModal(e)}," 編輯 ",8,h)])])))),128))])]),(0,l.Wm)(T,{pagination:S.pagination,onGetProducts:H.getOrderList},null,8,["pagination","onGetProducts"])]),(0,l._)("div",f,[(0,l._)("div",g,[(0,l._)("div",b,[w,(0,l._)("div",y,[(0,l._)("div",O,[(0,l._)("div",v,[(0,l.wy)((0,l._)("input",{type:"date",class:"form-control",id:"date",name:"date","onUpdate:modelValue":e[0]||(e[0]=t=>S.tempOrder.create_at=t)},null,512),[[r.nr,S.tempOrder.create_at]]),k]),(0,l._)("div",x,[(0,l._)("div",M,[(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",id:"floatingInput","onUpdate:modelValue":e[1]||(e[1]=t=>S.tempOrder.email=t)},null,512),[[r.nr,S.tempOrder.email]]),$]),(0,l._)("div",D,[(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",id:"floatingInput","onUpdate:modelValue":e[2]||(e[2]=t=>S.tempOrder.product=t)},null,512),[[r.nr,S.tempOrder.product]]),L]),(0,l._)("div",C,[(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",id:"floatingPassword","onUpdate:modelValue":e[3]||(e[3]=t=>S.tempOrder.total=t)},null,512),[[r.nr,S.tempOrder.total]]),I])]),(0,l._)("div",U,[(0,l.wy)((0,l._)("input",{class:"form-check-input",type:"checkbox",id:"flexSwitchCheckDefault","onUpdate:modelValue":e[4]||(e[4]=t=>S.tempOrder.is_paid=t)},null,512),[[r.e8,S.tempOrder.is_paid]]),P])])]),(0,l._)("div",V,[(0,l._)("button",{type:"button",class:"btn btn-primary",onClick:e[5]||(e[5]=(...t)=>H.updateOrder&&H.updateOrder(...t))}," 確認 ")])])])])])}a(7658);var S=a(7208),H=a(2166),T={components:{PagiNation:S.Z},data(){return{orders:[],pagination:{},myModal:{},tempOrder:{}}},methods:{getOrderList(t=1){const e=`https://vue-course-api.hexschool.io/api/weiwei2022/orders?page=${t}`;this.$http.get(e).then((t=>{this.orders=[];for(let e of t.data.orders){let t={id:e.id,create_at:new Date(e.create_at).toLocaleString(),email:e.email,is_paid:e.is_paid,total:e.total},a="";for(let l of Object.values(e.products))a+=`${l.product.title} ： ${l.qty}包 <br>`;t.product=a,this.orders.push(t)}this.pagination=t.data.pagination}))},openModal(t){this.tempOrder=Object.assign({},t),this.myModal.show()},updateOrder(){let t=`https://vue-course-api.hexschool.io/api/weiwei2022/admin/order/${this.tempOrder.id}`;this.$http.put(t,{data:this.tempOrder}).then((t=>{t.data.success&&(this.myModal.hide(),this.getOrderList())}))}},mounted(){this.myModal=new H.u_("#orderModal",{})},created(){const t=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");""!==t&&(this.axios.defaults.headers.common["Authorization"]=t,this.getOrderList())}},j=a(89);const E=(0,j.Z)(T,[["render",z]]);var G=E}}]);
//# sourceMappingURL=417.e560251e.js.map